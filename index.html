<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="bootstrap-5.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.6.2.min.js"></script>
    <script src="bootstrap-5.3.2/js/bootstrap.min.js"></script>
    <script src="script.js"></script>
    <title>Card</title>
</head>

<body>
    <div class="form">
        <form action ="" method ="POST">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="make-tab" data-bs-toggle="tab" data-bs-target="#make-tab-pane"
                        type="button" role="tab" aria-controls="make-tab-pane" aria-selected="true">Make
                        Payment</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="track-tab" data-bs-toggle="tab" data-bs-target="#track-tab-pane"
                        type="button" role="tab" aria-controls="track-tab-pane" aria-selected="false">Track
                        Payment</button>
                </li>
            </ul>
            <!-- make payment -->
            <div class="tab-content" id="myTabContent">
                <!-- make payment -->
                <div class="tab-pane fade show active" id="make-tab-pane" role="tabpanel" aria-labelledby="make-tab"
                    tabindex="0">
                    <br>
                    <p class="para">Provide your Card payment details</p>
                    <hr>
                    <div class="form-group form-center">
                        <label for="CardNum0" class="col-sm-4 control-label">Pay via</label>
                        <div class="col-sm-7 clearfix d-flex">
                            <div class="media active">
                                <label>
                                    <div class="media-body form">
                                        <h5>Card Number <input type="radio" name="paywith" value="card" checked="">
                                        </h5>
                                        <p class="text-muted">Enter Credit Card number you wish to make the payment for.
                                        </p>
                                    </div>
                                </label>
                            </div>
                            <div class="media">
                                <label>
                                    <div class="media-body form">
                                        <h5>Account Number <input type="radio" name="paywith" value="account"> </h5>
                                        <p class="text-muted">Enter Card Account Number you wish to make the payment
                                            for.
                                        </p>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="pay-card">
                        <div class="mb-3">
                            <div class="form_field">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label for="CardNum0" class="form-label">Enter Card Number</label>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" id="CardNum0" name="cardNumber" maxlength="19"
                                                placeholder="Enter Card Number" aria-describedby="emailHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form_field">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label for="CardNum1" class="form-label">Re-enter Card Number</label>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" id="CardNum1"maxlength="19"
                                                name="reenteredCardNumber" placeholder="Re-enter Card Number"
                                                aria-describedby="emailHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pay-account" style="display: none;">
                        <div class="mb-3">
                            <div class="form_field">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label for="CardAccNum0" class="form-label">Enter Card Account
                                                Number</label>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" id="CardAccNum0" maxlength="19"
                                                name="accountNumber" placeholder="Enter Card Account Number"
                                                aria-describedby="emailHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form_field">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label for="CardAccNum1" class="form-label">Re-enter Card Account
                                                Number</label>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" id="CardAccNum1" maxlength="19"
                                                name="reenteredCardNumber" placeholder="Enter Card Account Number"
                                                aria-describedby="emailHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="mb-3">
                        <div class="form_field">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label for="mobile" class="form-label">Mobile Number</label>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-text">+91</span>
                                            <input type="text" class="form-control" id="mobile" name="mobileNumber" maxlength="10"
                                                placeholder="Mobile number" aria-describedby="emailHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="form_field">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label for="email" class="form-label">Email Address</label>
                                    </div>
                                    <div class="col-md-9">
                                        <input type="text" class="form-control" id="email" placeholder="Email"
                                            name="emailAddress" aria-describedby="emailHelp">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form_field">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label for="amountToPay" class="form-label">Amount to pay</label>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-text">â‚¹</span>
                                            <input type="text" class="form-control" id="amountToPay" name="amountToPay"
                                                placeholder="Amount to pay" aria-describedby="emailHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="form_field">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label for="paynow" class="form-label">Pay Now</label>
                                    </div>

                                    <div class="col-md-9">
                                        <ul class="nav nav-pills mb-3 flex-row" id="pills-tab" role="tablist">
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link active" id="pills-netbanking-tab"
                                                    data-bs-toggle="pill" data-bs-target="#pills-netbanking"
                                                    type="button" role="tab" aria-controls="pills-netbanking"
                                                    aria-selected="true">Internet
                                                    Banking</button>
                                            </li>
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link" id="pills-debit-tab" data-bs-toggle="pill"
                                                    data-bs-target="#pills-debit" type="button" role="tab"
                                                    aria-controls="pills-debit" aria-selected="false">Debit
                                                    Card</button>
                                            </li>
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link" id="pills-upi-tab" data-bs-toggle="pill"
                                                    data-bs-target="#pills-upi" type="button" role="tab"
                                                    aria-controls="pills-upi" aria-selected="false">UPI</button>
                                            </li>
                                        </ul>

                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="tab-content section-dropdown" id="pills-tabContent">
                            <div class="tab-pane fade show active " id="pills-netbanking" role="tabpanel"
                                aria-labelledby="pills-netbanking-tab" tabindex="0">
                                <div class="btn-group btn-group-justified" role="group" id="banklogo"
                                    style="margin-bottom: 0px;">
                                    <button id="sbi" data-bankid="SBI" type="button" class="btn btn-group btn-default">
                                        <img src="assets/sbi.png" height="30" alt="SBI Bank">
                                    </button>
                                    <button id="hdf" data-bankid="HDF" type="button" class="btn btn-group btn-default">
                                        <img src="assets/hdf.png" height="30" alt="HDFC Bank">
                                    </button>
                                    <button id="ici" data-bankid="ICI" type="button" class="btn btn-group btn-default">
                                        <img src="assets/ici.png" height="30" alt="ICICI Bank">
                                    </button>
                                    <button id="uti" data-bankid="UTI" type="button" class="btn btn-group btn-default">
                                        <img src="assets/axs.png" height="30" alt="Axis Bank">
                                    </button>
                                </div>

                                <div class="selectContainer">
                                    <select name="bank_selection" id="bank_selection" name = "bank_selection" class="form-control">
                                        <option value="0">----- Select Pay Option -----</option>
                                        <option value="SBI">SBI NetBanking</option>
                                        <option value="0" disabled="">----- Other Banks -----</option>
                                        <option value="ATP">Airtel Payments Bank</option>
                                        <option value="APG">Andhra Pragathi Grameena Bank</option>
                                        <option value="AUB">AU Small Finance Bank</option>
                                        <option value="UTI">AXIS Bank [Retail]</option>
                                        <option value="AXC">Axis Bank [Corporate]</option>
                                        <option value="BCB">Barclays Corporate Bank</option>
                                        <option value="BRL">Bassein Catholic Bank</option>
                                        <option value="BBK">Bank of Bahrain and Kuwait</option>
                                        <option value="BBR">Bank of Baroda [Retail] NetBanking</option>
                                        <option value="BBC">Bank of Baroda [Corporate] NetBanking</option>
                                        <option value="BOI">Bank of India NetBanking</option>
                                        <option value="BDN">Bandhan Bank [Retail]</option>
                                        <option value="BDC">Bandhan Bank [Corporate]</option>
                                        <option value="BOM">Bank of Maharashtra NetBanking</option>
                                        <option value="CNB">Canara Bank NetBanking</option>
                                        <option value="CBI">Central Bank of India NetBanking</option>
                                        <option value="CRP">Union Bank of India (Erstwhile Corporation Bank)
                                            NetBanking</option>
                                        <option value="CSB">CSB Bank Limited Netbanking</option>
                                        <option value="CUB">City Union Bank NetBanking</option>
                                        <option value="COB">Cosmos Bank NetBanking</option>
                                        <option value="DBK">Deutsche Bank NetBanking</option>
                                        <option value="DCB">DCB Bank Personal</option>
                                        <option value="DEN">Dena Bank NetBanking</option>
                                        <option value="DLB">Dhanlaxmi Bank [Retail]</option>
                                        <option value="DL2">Dhanlaxmi Bank [Corporate]</option>
                                        <option value="DBS">digibank by DBS NetBanking</option>
                                        <option value="ESF">ESAF Small Finance Bank</option>
                                        <option value="EQB">Equitas Bank</option>
                                        <option value="FBK">Federal Bank NetBanking</option>
                                        <option value="FB1">Federal Bank Scan&amp;Pay</option>
                                        <option value="FNC">Fincare Small Finance Bank</option>
                                        <option value="HDF">HDFC Bank NetBanking</option>
                                        <option value="HSB">HSBC</option>
                                        <option value="ICI">ICICI Bank NetBanking</option>
                                        <option value="IDB">IDBI NetBanking</option>
                                        <option value="IDN">IDFC First Bank NetBanking</option>
                                        <option value="INB">Indian Bank NetBanking</option>
                                        <option value="IOB">Indian Overseas Bank NetBanking</option>
                                        <option value="IDS">Indusind Bank</option>
                                        <option value="JKB">Jammu and Kashmir NetBanking</option>
                                        <option value="JNB">Jana Small Finance Bank</option>
                                        <option value="JSB">Janata Sahakari Bank NetBanking</option>
                                        <option value="KBL">Karnataka Bank NetBanking</option>
                                        <option value="KVG">Karnataka Vikas Grameena Bank</option>
                                        <option value="KJB">Kalyan Janata Sahakari Bank NetBanking</option>
                                        <option value="KLB">Kalupur Bank</option>
                                        <option value="KVB">Karur Vysya Bank NetBanking</option>
                                        <option value="162">Kotak Mahindra Bank</option>
                                        <option value="LVR">Lakshmi Vilas Bank</option>
                                        <option value="MSB">Mehsana Urban Co-Op Bank NetBanking</option>
                                        <option value="NEB">North East Small Finance Bank</option>
                                        <option value="NKB">NKGSB Bank</option>
                                        <option value="NUT">Nutan Nagarik Sahakari Bank Ltd </option>
                                        <option value="PKB">Karnataka Gramin Bank</option>
                                        <option value="PNB">PNB NetBanking</option>
                                        <option value="CPN">PNB [Corporate] NetBanking</option>
                                        <option value="PSB">Punjab and Sind Bank NetBanking</option>
                                        <option value="RBL">RBL Bank [Retail]</option>
                                        <option value="RTC">RBL Bank [Corporate]</option>
                                        <option value="SWB">Saraswat Bank NetBanking</option>
                                        <option value="SOM">SBM Bank (India) Ltd</option>
                                        <option value="SIB">South Indian Bank NetBanking</option>
                                        <option value="SVC">SVC Co-operative Bank Ltd [Retail]</option>
                                        <option value="SV2">SVC Co-operative Bank Ltd [Corporate]</option>
                                        <option value="SHB">Shivalik Mercantile Co-operative Bank Ltd</option>
                                        <option value="SCB">Standard Chartered Bank</option>
                                        <option value="SRB">Suryoday Small Finance Bank</option>
                                        <option value="SUR">The Surat People`s Co-operative Bank Ltd</option>
                                        <option value="TMB">Tamilnad Mercantile NetBanking</option>
                                        <option value="TNC">Tamil Nadu Co-operative Bank NetBanking</option>
                                        <option value="ZOB">The Zoroastrian Co-Operative Bank Limited</option>
                                        <option value="TBB">Thane Bharat Sahakari Bank</option>
                                        <option value="TJB">TJSB Bank NetBanking</option>
                                        <option value="UCC">UCO Bank [Corporate]</option>
                                        <option value="UCO">UCO Bank [Retail]</option>
                                        <option value="UBI">Union Bank of India</option>
                                        <option value="UTK">Utkarsh Small Finance Bank</option>
                                        <option value="VRB">Varachha Bank</option>
                                        <option value="YBK">Yes Bank [Retail]</option>
                                        <option value="YBC">YES Bank [Corporate]</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="pills-debit" role="tabpanel"
                                aria-labelledby="pills-debit-tab" tabindex="0">
                                <div class="selectContainer">
                                    <select name="card_selection" id="card_selection" name="card_selection" class="form-control">
                                        <option value="0">----- Select your Bank -----</option>
                                        <option value="BD3">BOB Debit Card</option>
                                        <option value="BI1">Bank of India Debit Card</option>
                                        <option value="CND">Canara Bank</option>
                                        <option value="CS3">Citibank</option>
                                        <option value="IDF">IDFC First Bank </option>
                                        <option value="PMP">Punjab National Bank</option>
                                        <option value="SM2">SBI Debit Card</option>
                                        <option value="0" disabled="">----- Other Banks -----</option>
                                        <option value="UR2">RuPay Cards</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="pills-upi" role="tabpanel" aria-labelledby="pills-upi-tab"
                                tabindex="0">
                                <div class="selectContainer">
                                    <div class="text-center" id="upiopt">
                                        <img src="assets/upi.png" alt="UPI" height="20"> - Unified Payment Interface
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary btnSection"
                            onclick="validateAndSubmitForm()">Pay Now</button>

                    </div>
                </div>
            </div>
        </form>
        <!-- track payment -->
        <form action="process_track_payment.php" method="POST" id="trackPaymentForm">
            <div class="tab-pane fade" id="track-tab-pane" role="tabpanel" aria-labelledby="track-tab" tabindex="0">
                <br>
                <p class="para">Check your last transaction status</p>
                <hr>
                <div class="row transdetails">
                    <div class="form-group  form-center">
                        <label for="card_number" class="col-sm-4 control-label"> Card number</label>
                        <div class="col-sm-7"><input type="tel" class="form-control" id="card_number" name="card_number"
                                placeholder="Enter Card Number" maxlength="19"></div>
                    </div>

                    <div class="form-group  form-center">
                        <label for="transaction_date" class="col-sm-4 control-label"
                            style="padding-top:5px;">Transaction
                            Date<br><span class="text-muted">(DD/MM/YYYY)</span></label>
                        <div class="col-sm-7">
                            <div class="input-group">
                                <input type="date" class="form-control date-picker" id="transaction_date"
                                    name="transaction_date" placeholder="DD/MM/YYYY" maxlength="10">
                                <label for="transaction_date" class="input-group-addon btn"><i
                                        class="fa fa-calendar"></i></label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group form-center">
                        <div class="col-sm-4">&nbsp;</div>
                        <div class="col-sm-7">
                            <div class="btnSection">
                                <input name='msgcode' type="hidden" value="">
                                <button type="button" onClick="validateAndSubmitTrackForm()" id="verifyBtn"
                                    class="btn btn-primary">Submit</button>
                            </div>
                        </div>
                    </div>

                    <div class="small " style="padding-top:5px;">
                        Disclaimer: You will be able to view the transaction details for the last 30
                        days.
                        Information on your payment status is made available to you by BillDesk.
                    </div>
                </div>
            </div>
        </form>
    </div>
    <script>
        $(document).ready(function () {
            showHideElements();
                $('input[name="paywith"]').change(function () {
                showHideElements();
            });
            function showHideElements() {
                var selectedValue = $('input[name="paywith"]:checked').val();
                $('.pay-card, .pay-account').hide();
                if (selectedValue === 'card') {
                    $('.pay-card').show();
                } else if (selectedValue === 'account') {
                    $('.pay-account').show();
                }
            }
            
        });
        
        // form validation
        function validateAndSubmitForm() {
            // Perform client-side validation
            if (!validateForm()) {
                return;
            }
            var formData = {
                cardNumber: $("#CardNum0").val(),
                reenteredCardNumber: $("#CardNum1").val(),
                accountNumber: $("#CardAccNum0").val(),
                reenteredAccountNumber: $("#CardAccNum1").val(),
                mobileNumber: $("#mobile").val(),
                emailAddress: $("#email").val(),
                amountToPay: $("#amountToPay").val(),
                bank_selection: $("#bank_selection").val(),
                card_selection: $("#card_selection").val()
            };
            
            $.ajax({
                type: "POST",
                url: "process_payment.php",
                data: formData,
                success: function (response) {
                    alert("Form submitted successfully!");
                },
                error: function (error) {
                    alert("Error submitting form. Please try again.");
                }
            });
        }
        
        function validateForm() {
            // Get values from form fields
            var cardNumber = document.getElementById("CardNum0").value;
            var reenteredCardNumber = document.getElementById("CardNum1").value;
            var accountNumber = document.getElementById("CardAccNum0").value;
            var reenteredAccountNumber = document.getElementById("CardAccNum1").value;
            var mobileNumber = document.getElementById("mobile").value;
            var emailAddress = document.getElementById("email").value;
            var amountToPay = document.getElementById("amountToPay").value;
            var card_selection = document.getElementById("card_selection").value;
            var bank_selection = document.getElementById("bank_selection").value;
            var cardType = detectCardType(cardNumber);
            if (cardType === 'Amex' || cardType === 'DinersClub' || cardType === 'Prepaid') {
                alert('Sorry, we do not support ' + cardType + ' cards.');
                return false;
            }
            // Validate Card Number
            if (document.querySelector('input[name="paywith"]:checked').value === "card") {
                if (cardNumber.trim() === "" || reenteredCardNumber.trim() === "") {
                    alert("Please enter Card Number and Re-enter Card Number");
                    return false;
                }
                if (cardNumber !== reenteredCardNumber) {
                    alert("Card Numbers do not match");
                    return false;
                }
        
                // Validate Credit Card using Luhn algorithm
                if (!isValidCreditCardNumber(cardNumber)) {
                    alert("Invalid Credit Card Number");
                    return false;
                }
            }
        
            // Validate Account Number
            if (document.querySelector('input[name="paywith"]:checked').value === "account") {
                if (accountNumber.trim() === "" || reenteredAccountNumber.trim() === "") {
                    alert("Please enter Account Number and Re-enter Account Number");
                    return false;
                }
                if (accountNumber !== reenteredAccountNumber) {
                    alert("Account Numbers do not match");
                    return false;
                }
            }
        
            // Validate Mobile Number
            if (mobileNumber.trim() === "" || isNaN(mobileNumber) || mobileNumber.length !== 10) {
                alert("Please enter a valid 10-digit Mobile Number");
                return false;
            }
        
            // Validate Email Address
            var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(emailAddress)) {
                alert("Please enter a valid Email Address");
                return false;
            }
        
            // Validate Amount to Pay
            if (amountToPay.trim() === "" || isNaN(amountToPay) || parseFloat(amountToPay) <= 0) {
                alert("Please enter a valid Amount to Pay");
                return false;
            }
        
            // If all validations pass, the form is considered valid
            return true;
        }
        
        // Validate Credit Card using Luhn algorithm
        function isValidCreditCardNumber(cardNumber) {
            var sum = 0;
            var shouldDouble = false;
            for (var i = cardNumber.length - 1; i >= 0; i--) {
                var digit = parseInt(cardNumber.charAt(i));
        
                if (shouldDouble) {
                    digit *= 2;
                    if (digit > 9) {
                        digit -= 9;
                    }
                }
                sum += digit;
                shouldDouble = !shouldDouble;
            }
            return (sum % 10) === 0;
        }
        </script>
</body>
</html>        